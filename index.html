<!doctype html> 
<html lang="pt-BR">

<head>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Devocional ‚Ä¢ Vers√≠culos ACF</title>

  <!-- Fonte -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  >

  <style>
    :root {
      --glass-bg: rgba(15, 23, 42, 0.84);
      --glass-border: rgba(148, 163, 184, 0.45);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --accent: #facc15;
      --accent-soft: rgba(250, 204, 21, 0.16);
      --success: #22c55e;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: #020617;
      overflow: hidden;
    }

    /* Fundo com paisagem */
    .bg-image {
      position: fixed;
      inset: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      filter: brightness(0.55);
      z-index: -2;
      transition: background-image 0.7s ease-out, filter 0.4s ease-out;
    }

    .bg-overlay {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at top, rgba(15, 23, 42, 0.4) 0, rgba(15, 23, 42, 0.9) 55%, #020617 100%),
        linear-gradient(to bottom right, rgba(15, 23, 42, 0.7), rgba(15, 23, 42, 0.9));
      z-index: -1;
    }

    .app {
      max-width: 980px;
      width: 100%;
    }

    .card {
      background: var(--glass-bg);
      border-radius: 1.8rem;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(18px);
      box-shadow:
        0 24px 60px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(15, 23, 42, 0.8);
      padding: 24px 20px 20px;
    }

    @media (min-width: 768px) {
      .card {
        padding: 30px 32px 24px;
      }
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 22px;
      flex-wrap: wrap;
    }

    .title-area {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-muted);
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--success);
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.9);
    }

    .title {
      font-size: clamp(1.5rem, 3vw, 1.9rem);
      font-weight: 600;
      letter-spacing: -0.03em;
    }

    .title span.brand {
      background: linear-gradient(135deg, #facc15, #22d3ee);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .subtitle {
      font-size: 0.86rem;
      color: var(--text-muted);
      max-width: 440px;
    }

    .timer-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.65);
      font-size: 0.76rem;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .timer-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--accent-soft);
      border: 1px solid var(--accent);
      box-shadow: 0 0 12px rgba(250, 204, 21, 0.9);
      position: relative;
    }

    .timer-dot::after {
      content: "";
      position: absolute;
      inset: -4px;
      border-radius: inherit;
      border: 1px solid rgba(250, 204, 21, 0.35);
    }

    .layout {
      display: grid;
      gap: 20px;
    }

    @media (min-width: 780px) {
      .layout {
        grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.2fr);
        align-items: stretch;
      }
    }

    .verse-card {
      position: relative;
      border-radius: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.5);
      padding: 18px 18px 16px;
      background:
        radial-gradient(circle at top left, rgba(248, 250, 252, 0.06), transparent 60%),
        rgba(15, 23, 42, 0.96);
      overflow: hidden;
    }

    .verse-card::before {
      content: "‚Äú";
      position: absolute;
      font-size: 7rem;
      line-height: 1;
      top: -40px;
      left: 14px;
      opacity: 0.06;
    }

    .verse-ref {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.7);
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .version-tag {
      font-size: 0.68rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .verse-text {
      font-size: clamp(1.1rem, 2.2vw, 1.4rem);
      line-height: 1.7;
      margin-bottom: 16px;
      font-weight: 400;
    }

    .verse-helper {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .controls-card {
      border-radius: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: linear-gradient(
        145deg,
        rgba(15, 23, 42, 0.95),
        rgba(15, 23, 42, 0.88)
      );
      padding: 16px 16px 14px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 14px;
    }

    .progress-title {
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .progress-sub {
      font-size: 0.76rem;
      color: var(--text-muted);
    }

    .progress-bar-wrapper {
      margin-top: 10px;
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      border-radius: inherit;
      background: linear-gradient(90deg, #facc15, #22d3ee);
      transition: width 0.3s linear;
    }

    .progress-footer {
      margin-top: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.75rem;
      color: var(--text-muted);
      gap: 6px;
      flex-wrap: wrap;
    }

    .stat-pill {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.95);
      font-size: 0.74rem;
    }

    .primary-button {
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px 0;
      width: 100%;
      border-radius: 999px;
      border: none;
      font-size: 0.9rem;
      font-weight: 500;
      background: radial-gradient(circle at 0% 0%, #facc15, #f97316);
      color: #111827;
      cursor: pointer;
      box-shadow:
        0 12px 30px rgba(249, 115, 22, 0.55),
        0 0 0 1px rgba(248, 250, 252, 0.06);
      transition:
        transform 0.12s ease-out,
        box-shadow 0.12s ease-out,
        filter 0.12s ease-out;
    }

    .primary-button span.chevron {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.3);
      font-size: 0.8rem;
    }

    .primary-button:hover {
      transform: translateY(-1px);
      filter: brightness(1.03);
      box-shadow:
        0 18px 38px rgba(249, 115, 22, 0.7),
        0 0 0 1px rgba(248, 250, 252, 0.08);
    }

    .primary-button:active {
      transform: translateY(0);
      box-shadow:
        0 10px 24px rgba(249, 115, 22, 0.45),
        0 0 0 1px rgba(248, 250, 252, 0.05);
    }

    .footer {
      margin-top: 14px;
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.7rem;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
    }

    /* Anima√ß√£o suave */
    .fade-enter {
      opacity: 0;
      transform: translateY(6px);
    }
    .fade-enter-active {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.22s ease-out, transform 0.22s ease-out;
    }
  </style>

</head>

<body>

  <!-- Fundo com paisagem carregada por API -->
  <div class="bg-image" id="bgImage"></div>
  <div class="bg-overlay"></div>

  <main class="app">
    <section class="card">
      <header class="header">
        <div class="title-area">
          <div class="badge">
            <span class="badge-dot"></span>
            <span>Devocional ‚Ä¢ ACF online</span>
          </div>
          <h1 class="title">
            Versos em
            <span class="brand">foco</span>
          </h1>
          <p class="subtitle">
            Um vers√≠culo por vez, sobre uma paisagem tranquila,
            para voc√™ respirar, meditar e conversar com Deus.
          </p>
        </div>

        <div class="timer-pill">
          <div class="timer-dot"></div>
          <span>
            Pr√≥xima troca em <strong id="countdown">60s</strong>
          </span>
        </div>
      </header>

      <section class="layout">
        <article class="verse-card">
          <div class="verse-ref" id="verseRef">
            <span>Conectando √† AB√≠bliaDigital‚Ä¶</span>
            <span class="version-tag">ACF</span>
          </div>

          <p class="verse-text" id="verseText">
            Carregando primeiro vers√≠culo online‚Ä¶
          </p>

          <p class="verse-helper">
            Enquanto isso, aproveite a paisagem ao fundo como cen√°rio
            para a sua ora√ß√£o silenciosa.
          </p>
        </article>

        <aside class="controls-card">
          <div>
            <p class="progress-title">Sess√£o de leitura</p>
            <p class="progress-sub">
              Vers√≠culos exibidos hoje:
              <strong id="currentIndexLabel">0</strong>
            </p>

            <div class="progress-bar-wrapper">
              <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="progress-footer">
              <span>Pr√≥xima troca em <strong id="countdownInline">60s</strong></span>
              <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                <span class="stat-pill">
                  <span id="readCount">0</span> lidos
                </span>
                <span class="stat-pill" id="loopIndicator">
                  Come√ßando agora ‚ú®
                </span>
              </div>
            </div>
          </div>

          <button class="primary-button" id="nextButton" type="button">
            <span>Pr√≥ximo vers√≠culo</span>
            <span class="chevron">‚ûú</span>
          </button>
        </aside>
      </section>

      <footer class="footer">
        <div class="chips">
          <span class="chip">Versos ACF via API (com fallback)</span>
          <span class="chip">Paisagem aleat√≥ria</span>
          <span class="chip">Auto a cada 1 min</span>
        </div>
        <span>Texto b√≠blico fornecido por AB√≠bliaDigital.com.br quando dispon√≠vel.</span>
      </footer>
    </section>
  </main>

  <script>
    // =========================
    // CONFIGURA√á√ïES
    // =========================
    var BIBLE_API_BASE = "https://www.abibliadigital.com.br/api";
    var VERSION = "acf";
    var INTERVAL_MS = 60000; // 1 minuto

    // Paisagens: picsum.photos (placeholder com blur)
    var LANDSCAPE_URL_BASE = "https://picsum.photos/1600/900?blur=1&random=";

    // Refer√™ncias locais (fallback quando a API n√£o responder / CORS)
    var LOCAL_REFERENCES = [
      {
        reference: "Salmos 23:1 (ACF)",
        text: "Abra sua B√≠blia em Salmos 23:1 na vers√£o ACF e medite nessa verdade hoje."
      },
      {
        reference: "Jo√£o 3:16 (ACF)",
        text: "Abra sua B√≠blia em Jo√£o 3:16 na vers√£o ACF e relembre o amor de Deus por voc√™."
      },
      {
        reference: "Filipenses 4:6-7 (ACF)",
        text: "Leia Filipenses 4:6-7 na sua B√≠blia ACF e entregue suas preocupa√ß√µes em ora√ß√£o."
      },
      {
        reference: "Romanos 8:28 (ACF)",
        text: "Busque Romanos 8:28 na vers√£o ACF e descanse em como Deus conduz todas as coisas."
      },
      {
        reference: "Isa√≠as 41:10 (ACF)",
        text: "Leia Isa√≠as 41:10 em sua B√≠blia ACF e lembre-se de que Deus √© contigo."
      },
      {
        reference: "Prov√©rbios 3:5-6 (ACF)",
        text: "Medite em Prov√©rbios 3:5-6 na vers√£o ACF, confiando no Senhor de todo o cora√ß√£o."
      }
    ];

    // Estado
    var remainingMs = INTERVAL_MS;
    var timerId = null;
    var readCount = 0;
    var isLoadingVerse = false;

    // Elementos
    var verseRefEl = document.getElementById("verseRef");
    var verseTextEl = document.getElementById("verseText");
    var countdownEl = document.getElementById("countdown");
    var countdownInlineEl = document.getElementById("countdownInline");
    var progressBarEl = document.getElementById("progressBar");
    var currentIndexLabelEl = document.getElementById("currentIndexLabel");
    var readCountEl = document.getElementById("readCount");
    var loopIndicatorEl = document.getElementById("loopIndicator");
    var nextButton = document.getElementById("nextButton");
    var bgImageEl = document.getElementById("bgImage");

    // =========================
    // FUN√á√ïES AUXILIARES
    // =========================
    function formatSeconds(ms) {
      var sec = Math.ceil(ms / 1000);
      return sec + "s";
    }

    function updateCountdown() {
      var value = formatSeconds(remainingMs);
      countdownEl.textContent = value;
      countdownInlineEl.textContent = value;
      var percentage = 100 - (remainingMs / INTERVAL_MS) * 100;
      progressBarEl.style.width = percentage + "%";
    }

    function setFadeAnimation() {
      verseTextEl.classList.remove("fade-enter", "fade-enter-active");
      void verseTextEl.offsetWidth; // for√ßa reflow
      verseTextEl.classList.add("fade-enter");
      requestAnimationFrame(function () {
        verseTextEl.classList.add("fade-enter-active");
      });
    }

    function refreshBackground() {
      // usa timestamp para imagem diferente
      var url = LANDSCAPE_URL_BASE + Date.now();
      var img = new Image();
      img.onload = function () {
        bgImageEl.style.backgroundImage = 'url("' + url + '")';
      };
      img.onerror = function () {
        console.warn("Falha ao carregar imagem de fundo");
      };
      img.src = url;
    }

    function getRandomLocalVerse() {
      var index = Math.floor(Math.random() * LOCAL_REFERENCES.length);
      return LOCAL_REFERENCES[index];
    }

    // Tenta pegar vers√≠culo aleat√≥rio da API da B√≠blia Digital
    function fetchRandomVerseFromApi() {
      var url = BIBLE_API_BASE + "/verses/" + VERSION + "/random";

      return fetch(url, {
        headers: {
          "Authorization": "Bearer free"
        }
      })
        .then(function (res) {
          if (!res.ok) {
            throw new Error("Resposta n√£o OK da API: " + res.status);
          }
          return res.json();
        })
        .then(function (data) {
          var bookName = data.book && data.book.name ? data.book.name : "";
          var chapter = data.chapter || "";
          var number = data.number || "";
          var reference = bookName + " " + chapter + ":" + number;

          return {
            reference: reference,
            text: data.text || "Texto do vers√≠culo n√£o encontrado."
          };
        });
    }

    // Usa API + fallback local
    function getVerseWithFallback() {
      return fetchRandomVerseFromApi()
        .catch(function (err) {
          console.warn("Erro ao chamar API da B√≠blia Digital, usando fallback local:", err);
          return getRandomLocalVerse();
        });
    }

    function loadAndShowNewVerse() {
      if (isLoadingVerse) return;
      isLoadingVerse = true;

      verseRefEl.innerHTML = '\
        <span>Carregando vers√≠culo‚Ä¶</span>\
        <span class="version-tag">ACF</span>\
      ';
      verseTextEl.textContent = "Buscando vers√≠culo aleat√≥rio‚Ä¶";

      getVerseWithFallback()
        .then(function (verse) {
          verseRefEl.innerHTML = '\
            <span>' + verse.reference + '</span>\
            <span class="version-tag">ACF</span>\
          ';
          verseTextEl.textContent = verse.text;

          readCount++;
          readCountEl.textContent = String(readCount);
          currentIndexLabelEl.textContent = String(readCount);

          if (readCount === 1) {
            loopIndicatorEl.textContent = "Primeiro passo do dia üôå";
          } else if (readCount >= 5 && readCount < 15) {
            loopIndicatorEl.textContent = "Ritmo bom de medita√ß√£o üíõ";
          } else if (readCount >= 15) {
            loopIndicatorEl.textContent = "Sess√£o profunda de leitura üî•";
          }

          setFadeAnimation();
          refreshBackground();
        })
        .catch(function (err) {
          console.error(err);
          verseRefEl.innerHTML = '\
            <span>Erro ao carregar</span>\
            <span class="version-tag">ACF</span>\
          ';
          verseTextEl.textContent =
            "N√£o foi poss√≠vel carregar o vers√≠culo agora. Verifique sua conex√£o ou tente novamente em alguns instantes.";
        })
        .finally(function () {
          isLoadingVerse = false;
        });
    }

    function startTimer() {
      if (timerId) {
        clearInterval(timerId);
      }
      remainingMs = INTERVAL_MS;
      updateCountdown();

      timerId = setInterval(function () {
        remainingMs -= 1000;
        if (remainingMs <= 0) {
          remainingMs = INTERVAL_MS;
          updateCountdown();
          loadAndShowNewVerse();
        } else {
          updateCountdown();
        }
      }, 1000);
    }

    function resetTimer() {
      remainingMs = INTERVAL_MS;
      updateCountdown();
    }

    // =========================
    // INICIALIZA√á√ÉO
    // =========================
    (function init() {
      refreshBackground();
      loadAndShowNewVerse();
      startTimer();
    })();

    nextButton.addEventListener("click", function () {
      resetTimer();
      loadAndShowNewVerse();
    });
  </script>
</body>

</html>
